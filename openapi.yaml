openapi: 3.1.1
info:
  title: OpenAI Relay API
  version: "1.0.0"
  description: BIFL-grade relay with essential OpenAI endpoints (including newest thread/run/message retrieval endpoints)
servers:
  - url: https://chatgpt-team-relay.onrender.com

paths:
  /v1/chat/completions:
    post:
      operationId: chatCompletions_create
      summary: Create chat completion
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [model, messages]
              properties:
                model: { type: string }
                messages:
                  type: array
                  items:
                    type: object
                    required: [role, content]
                    properties:
                      role: { type: string, enum: [user, assistant, system, tool] }
                      content: { type: string }
                stream: { type: boolean, default: false }
      responses:
        '200': { description: Chat completion created }

  /v1/embeddings:
    post:
      operationId: embeddings_create
      summary: Create embedding
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [model, input]
              properties:
                model: { type: string }
                input: { type: string }
      responses:
        '200': { description: Embedding created }

  /v1/files:
    post:
      operationId: files_upload
      summary: Upload file
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file: { type: string, format: binary }
      responses:
        '200': { description: File uploaded }
    get:
      operationId: files_list
      summary: List files
      responses:
        '200': { description: File list }

  /v1/files/{file_id}:
    get:
      operationId: files_retrieve
      summary: Get file
      parameters:
        - name: file_id
          in: path
          required: true
          schema: { type: string }
      responses:
        '200': { description: File details }
    delete:
      operationId: files_delete
      summary: Delete file
      parameters:
        - name: file_id
          in: path
          required: true
          schema: { type: string }
      responses:
        '200': { description: File deleted }

  /v1/images/generations:
    post:
      operationId: images_generate
      summary: Generate image
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [model, prompt]
              properties:
                model: { type: string }
                prompt: { type: string }
                n: { type: integer }
      responses:
        '200': { description: Image created }

  /v1/audio/speech:
    post:
      operationId: audio_tts
      summary: Text to speech
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [model, input]
              properties:
                model: { type: string }
                input: { type: string }
      responses:
        '200': { description: Audio created }

  /v1/audio/transcriptions:
    post:
      operationId: audio_transcribe
      summary: Transcribe audio
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file: { type: string, format: binary }
                model: { type: string }
      responses:
        '200': { description: Transcription created }

  /v1/audio/translation:
    post:
      operationId: audio_translate
      summary: Translate audio
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file: { type: string, format: binary }
                model: { type: string }
      responses:
        '200': { description: Translation created }

  /v1/models:
    get:
      operationId: models_list
      summary: List available models
      responses:
        '200': { description: Model list }

  /v1/assistants:
    post:
      operationId: assistants_create
      summary: Create assistant
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [model, instructions]
              properties:
                model: { type: string }
                instructions: { type: string }
      responses:
        '200': { description: Assistant created }

  /v1/assistants/{assistant_id}/files:
    get:
      operationId: assistants_list_files
      summary: List assistant files
      parameters:
        - name: assistant_id
          in: path
          required: true
          schema: { type: string }
      responses:
        '200': { description: Files for assistant }
    post:
      operationId: assistants_attach_file
      summary: Attach file to assistant
      parameters:
        - name: assistant_id
          in: path
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [file_id]
              properties:
                file_id: { type: string }
      responses:
        '200': { description: File attached }
    delete:
      operationId: assistants_remove_file
      summary: Remove file from assistant
      parameters:
        - name: assistant_id
          in: path
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [file_id]
              properties:
                file_id: { type: string }
      responses:
        '200': { description: File removed }

  /v1/threads:
    post:
      operationId: threads_create
      summary: Create thread
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                messages:
                  type: array
                  items:
                    type: object
                    required: [role, content]
                    properties:
                      role: { type: string, enum: [user, assistant] }
                      content: { type: string }
                metadata:
                  type: object
                  additionalProperties: true
      responses:
        '200': { description: Thread created }

  /v1/threads/{thread_id}/messages:
    post:
      operationId: threads_add_message
      summary: Add message
      parameters:
        - name: thread_id
          in: path
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [role, content]
              properties:
                role: { type: string, enum: [user, assistant] }
                content: { type: string }
      responses:
        '200': { description: Message added }

  /v1/threads/{thread_id}/messages/{message_id}:
    get:
      operationId: threads_get_message
      summary: Get a specific message in a thread
      parameters:
        - name: thread_id
          in: path
          required: true
          schema: { type: string }
        - name: message_id
          in: path
          required: true
          schema: { type: string }
      responses:
        '200': { description: Message retrieved }

  /v1/threads/{thread_id}/messages/{message_id}/files:
    get:
      operationId: threads_list_message_files
      summary: List files for a message
      parameters:
        - name: thread_id
          in: path
          required: true
          schema: { type: string }
        - name: message_id
          in: path
          required: true
          schema: { type: string }
      responses:
        '200': { description: Files for message }

  /v1/threads/{thread_id}/runs:
    post:
      operationId: threads_create_run
      summary: Create run
      parameters:
        - name: thread_id
          in: path
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                assistant_id: { type: string }
      responses:
        '200': { description: Run created }

  /v1/threads/{thread_id}/runs/{run_id}:
    get:
      operationId: threads_get_run
      summary: Get run status for a thread
      parameters:
        - name: thread_id
          in: path
          required: true
          schema: { type: string }
        - name: run_id
          in: path
          required: true
          schema: { type: string }
      responses:
        '200': { description: Run retrieved }

  /v1/threads/{thread_id}/runs/{run_id}/steps:
    get:
      operationId: threads_list_run_steps
      summary: List steps for a run
      parameters:
        - name: thread_id
          in: path
          required: true
          schema: { type: string }
        - name: run_id
          in: path
          required: true
          schema: { type: string }
      responses:
        '200': { description: Run steps listed }

  /v1/vector_stores:
    get:
      operationId: vectorStores_list
      summary: List vector stores
      responses:
        '200': { description: Vector stores listed }
    post:
      operationId: vectorStores_create
      summary: Create vector store
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name: { type: string }
      responses:
        '200': { description: Vector store created }

  /v1/vector_stores/{vector_store_id}/queries:
    post:
      operationId: vectorStores_query
      summary: Query vector store
      parameters:
        - name: vector_store_id
          in: path
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                query: { type: string }
      responses:
        '200': { description: Vector store queried }

  /v1/vector_stores/{vector_store_id}/files:
    get:
      operationId: vectorStores_list_files
      summary: List files in a vector store
      parameters:
        - name: vector_store_id
          in: path
          required: true
          schema: { type: string }
      responses:
        '200': { description: Vector store files listed }

  /v1/vector_stores/{vector_store_id}/file_batches:
    get:
      operationId: vectorStores_list_file_batches
      summary: List file batches for a vector store
      parameters:
        - name: vector_store_id
          in: path
          required: true
          schema: { type: string }
      responses:
        '200': { description: File batches listed }

  /v1/videos:
    post:
      operationId: videos_create
      summary: Create video (Sora)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [prompt]
              properties:
                prompt: { type: string }
                model: { type: string }
      responses:
        '200': { description: Video created }

  /v1/videos/{video_id}:
    get:
      operationId: videos_get
      summary: Get video status
      parameters:
        - name: video_id
          in: path
          required: true
          schema: { type: string }
      responses:
        '200': { description: Video status }

  /v1/videos/{video_id}/remix:
    post:
      operationId: videos_remix
      summary: Remix video
      parameters:
        - name: video_id
          in: path
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [prompt]
              properties:
                prompt: { type: string }
      responses:
        '200': { description: Remix created }

components:
  schemas: {}

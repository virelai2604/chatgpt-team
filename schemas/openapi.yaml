openapi: 3.1.0
info:
  title: ChatGPT Team Relay API
  version: "1.0.0"
  description: |
    A relay that forwards ChatGPT-style requests to the OpenAI REST API.
    Core routes mirror OpenAI's /v1 endpoints, especially:
    - /v1/responses for chat-style interactions
    - /v1/embeddings for vector embeddings
    - /v1/models, /v1/files, /v1/tools for metadata and tooling

servers:
  - url: https://chatgpt-team-relay.onrender.com

paths:
  /health:
    get:
      operationId: getHealth
      summary: Health check for the relay service
      responses:
        "200":
          description: Relay is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: ok

  /v1/responses:
    post:
      operationId: createResponse
      summary: Create a response (chat-style, tool-calling, etc.)
      description: >
        Forwards to OpenAI's /v1/responses endpoint. Use this for chat-style
        messages, reasoning models, and tool-calling.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: OpenAI Responses payload
              properties:
                model:
                  type: string
                  example: gpt-4.1-mini
                input:
                  anyOf:
                    - type: string
                    - type: array
                      items:
                        anyOf:
                          - type: string
                          - type: object
                max_output_tokens:
                  type: integer
                  nullable: true
                stream:
                  type: boolean
                  description: If true, returns a Server-Sent Events stream.
                  default: false
      responses:
        "200":
          description: Response from OpenAI's /v1/responses
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseObject"

  /v1/embeddings:
    post:
      operationId: createEmbedding
      summary: Create embeddings
      description: Forwards to OpenAI's /v1/embeddings endpoint.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                model:
                  type: string
                  example: text-embedding-3-small
                input:
                  anyOf:
                    - type: string
                    - type: array
                      items:
                        type: string
      responses:
        "200":
          description: Embeddings result
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmbeddingResponse"

  /v1/models:
    get:
      operationId: listModels
      summary: List available models
      description: Forwards to OpenAI's /v1/models endpoint.
      responses:
        "200":
          description: List of models
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ModelList"

  /v1/tools:
    get:
      operationId: listRelayTools
      summary: List tools exposed by the relay
      description: >
        Returns a list of tools that this relay exposes. This is
        not part of the official OpenAI REST API, but is provided
        as a convenience for the ChatGPT Team environment.
      responses:
        "200":
          description: List of tools
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ToolList"

  /v1/files:
    get:
      operationId: listFiles
      summary: List files
      description: Forwards to OpenAI's /v1/files endpoint.
      responses:
        "200":
          description: List of files
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FileList"

  /v1/vector_stores:
    get:
      operationId: listVectorStores
      summary: List vector stores
      description: Forwards to OpenAI's /v1/vector_stores endpoint.
      responses:
        "200":
          description: List of vector stores
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/VectorStoreList"

components:
  schemas:
    ResponseObject:
      type: object
      description: >
        Simplified representation of the OpenAI /v1/responses object.
      properties:
        id:
          type: string
        object:
          type: string
          example: response
        model:
          type: string
        status:
          type: string
          example: completed
        output:
          type: array
          description: List of output items (messages, tool calls, etc.)
          items:
            type: object

    EmbeddingResponse:
      type: object
      properties:
        object:
          type: string
          example: list
        data:
          type: array
          items:
            type: object
            properties:
              object:
                type: string
                example: embedding
              embedding:
                type: array
                items:
                  type: number
              index:
                type: integer
        model:
          type: string

    ModelList:
      type: object
      properties:
        object:
          type: string
          example: list
        data:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
              object:
                type: string
                example: model
              created:
                type: integer
              owned_by:
                type: string

    ToolList:
      type: object
      properties:
        object:
          type: string
          example: list
        data:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
                example: web_search
              name:
                type: string
              type:
                type: string
                example: function
              description:
                type: string
              parameters:
                type: object

    FileList:
      type: object
      properties:
        object:
          type: string
          example: list
        data:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
              object:
                type: string
                example: file
              bytes:
                type: integer
              created_at:
                type: integer
              filename:
                type: string
              purpose:
                type: string

    VectorStoreList:
      type: object
      properties:
        object:
          type: string
          example: list
        data:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
              object:
                type: string
                example: vector_store
              created_at:
                type: integer
              name:
                type: string
                nullable: true
              status:
                type: string
